{"version":3,"sources":["../../../../app/dashboard/users/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faUsers, faPlus, faTrash, faEdit, faShieldAlt, faUserEdit, faUser, faEnvelope, faClock, faCheckCircle, faTimesCircle } from '@fortawesome/free-solid-svg-icons'\nimport type { FamilyUser, UserRole, Invitation } from '@/types'\nimport { getFamilyId, isAdmin, getUserRole } from '@/lib/db-helpers-client'\n\nexport const dynamic = 'force-dynamic'\n\nexport default function UserManagement() {\n  const [users, setUsers] = useState<FamilyUser[]>([])\n  const [invitations, setInvitations] = useState<Invitation[]>([])\n  const [familyId, setFamilyId] = useState<string | null>(null)\n  const [currentUserRole, setCurrentUserRole] = useState<UserRole | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [isAdding, setIsAdding] = useState(false)\n  const [isInviting, setIsInviting] = useState(false)\n  const [editingUser, setEditingUser] = useState<FamilyUser | null>(null)\n  const [newUser, setNewUser] = useState({\n    email: '',\n    role: 'member' as UserRole,\n  })\n  const [newInvitation, setNewInvitation] = useState({\n    email: '',\n    role: 'member' as UserRole,\n  })\n  const [error, setError] = useState<string | null>(null)\n  const supabase = createClient()\n\n  const roleOptions: { value: UserRole; label: string; icon: any; description: string }[] = [\n    { value: 'admin', label: 'Admin', icon: faShieldAlt, description: 'Can manage the family account' },\n    { value: 'editor', label: 'Editor', icon: faUserEdit, description: 'Can update account data, cannot manage members' },\n    { value: 'member', label: 'Member', icon: faUser, description: 'Can only view the data' },\n  ]\n\n  useEffect(() => {\n    loadData()\n  }, [])\n\n  const loadData = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (user) {\n        const fid = await getFamilyId(supabase)\n        console.log('Users page - Family ID:', fid)\n        if (fid) {\n          setFamilyId(fid)\n          const role = await getUserRole(supabase, fid)\n          console.log('Users page - User role:', role)\n          setCurrentUserRole(role)\n          \n          if (role === 'admin') {\n            await loadUsers(fid)\n            await loadInvitations(fid)\n          } else {\n            setError(`You do not have permission to manage users. Your role: ${role || 'none'}`)\n          }\n        } else {\n          setError('No family found. Please complete onboarding first.')\n        }\n      }\n    } catch (error) {\n      console.error('Error loading data:', error)\n      setError(`Failed to load user data: ${error instanceof Error ? error.message : 'Unknown error'}`)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadUsers = async (fid: string) => {\n    const { data, error } = await supabase\n      .from('family_users')\n      .select('*')\n      .eq('family_id', fid)\n      .order('created_at', { ascending: false })\n\n    if (error) {\n      console.error('Error loading users:', error)\n      setError('Failed to load users')\n      return\n    }\n\n    const usersWithEmail = await Promise.all(\n      (data || []).map(async (fu: any) => {\n        const response = await fetch(`/api/get-user-email?userId=${fu.user_id}`)\n        const result = await response.json()\n        return {\n          ...fu,\n          email: result.email || 'Unknown',\n        }\n      })\n    )\n\n    setUsers(usersWithEmail)\n  }\n\n  const loadInvitations = async (fid: string) => {\n    const response = await fetch(`/api/invitations?familyId=${fid}`)\n    const result = await response.json()\n    if (result.success) {\n      setInvitations(result.data || [])\n    }\n  }\n\n  const handleCreateInvitation = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError(null)\n\n    if (!familyId) return\n\n    try {\n      const response = await fetch('/api/invitations', {\n        method: 'POST',\n        headers: { 'Content-Type': 'application/json' },\n        body: JSON.stringify({\n          email: newInvitation.email,\n          role: newInvitation.role,\n          familyId: familyId,\n        }),\n      })\n\n      const result = await response.json()\n\n      if (!response.ok) {\n        throw new Error(result.message || result.error || 'Failed to create invitation')\n      }\n\n      await loadInvitations(familyId)\n      setNewInvitation({ email: '', role: 'member' })\n      setIsInviting(false)\n    } catch (err: any) {\n      console.error('Error creating invitation:', err)\n      setError(err.message || 'Failed to create invitation')\n    }\n  }\n\n  const handleDeleteInvitation = async (id: string) => {\n    if (!confirm('Are you sure you want to cancel this invitation?')) return\n\n    try {\n      const response = await fetch(`/api/invitations?id=${id}`, {\n        method: 'DELETE',\n      })\n\n      if (!response.ok) {\n        throw new Error('Failed to delete invitation')\n      }\n\n      if (familyId) await loadInvitations(familyId)\n    } catch (error) {\n      console.error('Error deleting invitation:', error)\n      alert('Failed to cancel invitation')\n    }\n  }\n\n  const getInvitationLink = (token: string) => {\n    const baseUrl = window.location.origin\n    return `${baseUrl}/auth/signup?token=${token}`\n  }\n\n  const copyInvitationLink = (token: string) => {\n    const link = getInvitationLink(token)\n    navigator.clipboard.writeText(link)\n    alert('Invitation link copied to clipboard!')\n  }\n\n  const handleAddUser = async (e: React.FormEvent) => {\n    e.preventDefault()\n    setError(null)\n\n    if (!familyId) return\n\n    try {\n      if (editingUser) {\n        const { error: updateError } = await supabase\n          .from('family_users')\n          .update({ role: newUser.role })\n          .eq('id', editingUser.id)\n\n        if (updateError) throw updateError\n      } else {\n        const response = await fetch('/api/add-family-user', {\n          method: 'POST',\n          headers: {\n            'Content-Type': 'application/json',\n          },\n          body: JSON.stringify({\n            email: newUser.email,\n            role: newUser.role,\n            familyId: familyId,\n          }),\n        })\n\n        const result = await response.json()\n\n        if (!response.ok) {\n          throw new Error(result.message || result.error || 'Failed to add user')\n        }\n      }\n\n      await loadUsers(familyId)\n      setNewUser({ email: '', role: 'member' })\n      setIsAdding(false)\n      setEditingUser(null)\n    } catch (err: any) {\n      console.error('Error saving user:', err)\n      setError(err.message || 'Failed to save user')\n    }\n  }\n\n  const handleEditUser = (user: FamilyUser) => {\n    setEditingUser(user)\n    setNewUser({\n      email: user.email || '',\n      role: user.role,\n    })\n    setIsAdding(true)\n  }\n\n  const handleDeleteUser = async (id: string) => {\n    if (!confirm('Are you sure you want to remove this user from your family?')) return\n\n    try {\n      const { error } = await supabase\n        .from('family_users')\n        .delete()\n        .eq('id', id)\n\n      if (error) throw error\n      if (familyId) await loadUsers(familyId)\n    } catch (error) {\n      console.error('Error deleting user:', error)\n      alert('Failed to remove user')\n    }\n  }\n\n  const getRoleIcon = (role: UserRole) => {\n    const roleOption = roleOptions.find(r => r.value === role)\n    return roleOption?.icon || faUser\n  }\n\n  const getRoleLabel = (role: UserRole) => {\n    const roleOption = roleOptions.find(r => r.value === role)\n    return roleOption?.label || role\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    )\n  }\n\n  if (currentUserRole !== 'admin') {\n    return (\n      <div className=\"max-w-7xl mx-auto\">\n        <div className=\"card text-center py-12\">\n          <FontAwesomeIcon icon={faShieldAlt} className=\"text-6xl text-gray-300 mb-4\" />\n          <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">Access Denied</h3>\n          <p className=\"text-gray-600\">You need admin permissions to manage users.</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-8\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"w-12 h-12 bg-purple-500 rounded-lg flex items-center justify-center\">\n            <FontAwesomeIcon icon={faUsers} className=\"text-white text-xl\" />\n          </div>\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">User Management</h1>\n            <p className=\"text-gray-600\">Manage family members and their permissions</p>\n          </div>\n        </div>\n\n        <div className=\"flex gap-3\">\n          <button\n            onClick={() => {\n              setIsInviting(!isInviting)\n              setIsAdding(false)\n              setNewInvitation({ email: '', role: 'member' })\n              setError(null)\n            }}\n            className=\"btn-secondary\"\n          >\n            <FontAwesomeIcon icon={faEnvelope} className=\"mr-2\" />\n            Invite User\n          </button>\n          <button\n            onClick={() => {\n              setIsAdding(!isAdding)\n              setIsInviting(false)\n              setEditingUser(null)\n              setNewUser({ email: '', role: 'member' })\n              setError(null)\n            }}\n            className=\"btn-primary\"\n          >\n            <FontAwesomeIcon icon={faPlus} className=\"mr-2\" />\n            Add User\n          </button>\n        </div>\n      </div>\n\n      {error && (\n        <div className=\"mb-6 bg-red-50 border border-red-200 text-red-600 px-4 py-3 rounded-lg\">\n          {error}\n        </div>\n      )}\n\n      {isInviting && (\n        <div className=\"card mb-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\n            Invite Family Member\n          </h2>\n          <form onSubmit={handleCreateInvitation} className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Email Address\n                </label>\n                <input\n                  type=\"email\"\n                  value={newInvitation.email}\n                  onChange={(e) => setNewInvitation({ ...newInvitation, email: e.target.value })}\n                  className=\"input-field\"\n                  placeholder=\"user@example.com\"\n                  required\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  They will receive an invitation link to sign up\n                </p>\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Role\n                </label>\n                <select\n                  value={newInvitation.role}\n                  onChange={(e) => setNewInvitation({ ...newInvitation, role: e.target.value as UserRole })}\n                  className=\"input-field\"\n                  required\n                >\n                  {roleOptions.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  {roleOptions.find(r => r.value === newInvitation.role)?.description}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex space-x-3\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setIsInviting(false)\n                  setNewInvitation({ email: '', role: 'member' })\n                  setError(null)\n                }}\n                className=\"btn-secondary\"\n              >\n                Cancel\n              </button>\n              <button type=\"submit\" className=\"btn-primary\">\n                Send Invitation\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      {isAdding && (\n        <div className=\"card mb-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">\n            {editingUser ? 'Edit User Role' : 'Add Family Member'}\n          </h2>\n          <form onSubmit={handleAddUser} className=\"space-y-6\">\n            <div className=\"grid md:grid-cols-2 gap-4\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Email Address\n                </label>\n                <input\n                  type=\"email\"\n                  value={newUser.email}\n                  onChange={(e) => setNewUser({ ...newUser, email: e.target.value })}\n                  className=\"input-field\"\n                  placeholder=\"user@example.com\"\n                  required\n                  disabled={!!editingUser}\n                />\n                {editingUser && (\n                  <p className=\"text-xs text-gray-500 mt-1\">Email cannot be changed</p>\n                )}\n              </div>\n\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Role\n                </label>\n                <select\n                  value={newUser.role}\n                  onChange={(e) => setNewUser({ ...newUser, role: e.target.value as UserRole })}\n                  className=\"input-field\"\n                  required\n                >\n                  {roleOptions.map((option) => (\n                    <option key={option.value} value={option.value}>\n                      {option.label}\n                    </option>\n                  ))}\n                </select>\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  {roleOptions.find(r => r.value === newUser.role)?.description}\n                </p>\n              </div>\n            </div>\n\n            <div className=\"flex space-x-3\">\n              <button\n                type=\"button\"\n                onClick={() => {\n                  setIsAdding(false)\n                  setEditingUser(null)\n                  setNewUser({ email: '', role: 'member' })\n                  setError(null)\n                }}\n                className=\"btn-secondary\"\n              >\n                Cancel\n              </button>\n              <button type=\"submit\" className=\"btn-primary\">\n                {editingUser ? 'Update Role' : 'Add User'}\n              </button>\n            </div>\n          </form>\n        </div>\n      )}\n\n      {invitations.length > 0 && (\n        <div className=\"card mb-6\">\n          <h2 className=\"text-xl font-semibold text-gray-900 mb-4\">Pending Invitations</h2>\n          <div className=\"space-y-3\">\n            {invitations.map((invitation) => (\n              <div key={invitation.id} className=\"flex items-center justify-between p-4 bg-gray-50 rounded-lg\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3\">\n                    <FontAwesomeIcon \n                      icon={invitation.status === 'pending' ? faClock : invitation.status === 'accepted' ? faCheckCircle : faTimesCircle} \n                      className={`text-lg ${\n                        invitation.status === 'pending' ? 'text-yellow-600' : \n                        invitation.status === 'accepted' ? 'text-green-600' : \n                        'text-gray-400'\n                      }`} \n                    />\n                    <div>\n                      <p className=\"font-medium text-gray-900\">{invitation.email}</p>\n                      <p className=\"text-sm text-gray-600\">\n                        Role: {getRoleLabel(invitation.role)} â€¢ \n                        {invitation.status === 'pending' ? (\n                          <span className=\"text-yellow-600\"> Pending</span>\n                        ) : invitation.status === 'accepted' ? (\n                          <span className=\"text-green-600\"> Accepted</span>\n                        ) : (\n                          <span className=\"text-gray-400\"> {invitation.status}</span>\n                        )}\n                      </p>\n                      {invitation.status === 'pending' && (\n                        <button\n                          onClick={() => copyInvitationLink(invitation.token)}\n                          className=\"text-xs text-indigo-600 hover:text-indigo-700 mt-1\"\n                        >\n                          Copy invitation link\n                        </button>\n                      )}\n                    </div>\n                  </div>\n                </div>\n                {invitation.status === 'pending' && (\n                  <button\n                    onClick={() => handleDeleteInvitation(invitation.id)}\n                    className=\"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 transition-colors\"\n                    title=\"Cancel invitation\"\n                  >\n                    <FontAwesomeIcon icon={faTrash} />\n                  </button>\n                )}\n              </div>\n            ))}\n          </div>\n        </div>\n      )}\n\n      {users.length === 0 ? (\n        <div className=\"text-center py-12 card\">\n          <FontAwesomeIcon icon={faUsers} className=\"text-6xl text-gray-300 mb-4\" />\n          <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">No Users Yet</h3>\n          <p className=\"text-gray-600 mb-6\">Add family members to share access</p>\n          <button\n            onClick={() => setIsAdding(true)}\n            className=\"btn-primary\"\n          >\n            <FontAwesomeIcon icon={faPlus} className=\"mr-2\" />\n            Add Your First User\n          </button>\n        </div>\n      ) : (\n        <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n          {users.map((user) => (\n            <div key={user.id} className=\"card hover:shadow-lg transition-shadow\">\n              <div className=\"flex items-start justify-between\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center space-x-3 mb-3\">\n                    <div className=\"w-12 h-12 rounded-full bg-gradient-to-br from-indigo-400 to-purple-500 flex items-center justify-center\">\n                      <FontAwesomeIcon icon={getRoleIcon(user.role)} className=\"text-white text-xl\" />\n                    </div>\n                    <div>\n                      <h3 className=\"text-lg font-semibold text-gray-900\">{user.email}</h3>\n                      <p className=\"text-sm text-gray-600\">{getRoleLabel(user.role)}</p>\n                    </div>\n                  </div>\n                  <p className=\"text-xs text-gray-500\">\n                    {roleOptions.find(r => r.value === user.role)?.description}\n                  </p>\n                </div>\n                \n                <div className=\"flex flex-col gap-2\">\n                  <button\n                    onClick={() => handleEditUser(user)}\n                    className=\"text-indigo-600 hover:text-indigo-700 p-2 rounded-lg hover:bg-indigo-50 transition-colors\"\n                    title=\"Edit role\"\n                  >\n                    <FontAwesomeIcon icon={faEdit} />\n                  </button>\n                  {users.length > 1 && (\n                    <button\n                      onClick={() => handleDeleteUser(user.id)}\n                      className=\"text-red-600 hover:text-red-700 p-2 rounded-lg hover:bg-red-50 transition-colors\"\n                      title=\"Remove user\"\n                    >\n                      <FontAwesomeIcon icon={faTrash} />\n                    </button>\n                  )}\n                </div>\n              </div>\n            </div>\n          ))}\n        </div>\n      )}\n    </div>\n  )\n}\n\n"],"names":[],"mappings":"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"}