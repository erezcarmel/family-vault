{"version":3,"sources":["../../../../app/dashboard/insurance/page.tsx"],"sourcesContent":["'use client'\n\nimport { useEffect, useState } from 'react'\nimport { createClient } from '@/lib/supabase/client'\nimport { FontAwesomeIcon } from '@fortawesome/react-fontawesome'\nimport { faPlus, faShieldAlt } from '@fortawesome/free-solid-svg-icons'\nimport AssetCard from '@/components/AssetCard'\nimport AssetModal from '@/components/AssetModal'\nimport type { Asset, AssetType } from '@/types'\n\nexport const dynamic = 'force-dynamic'\n\nconst subCategories: { id: AssetType; title: string }[] = [\n  { id: 'life_insurance', title: 'Life Insurance' },\n  { id: 'home_insurance', title: 'Home Insurance' },\n  { id: 'health_insurance', title: 'Health Insurance' },\n]\n\nexport default function Insurance() {\n  const [assets, setAssets] = useState<Asset[]>([])\n  const [familyId, setFamilyId] = useState<string | null>(null)\n  const [loading, setLoading] = useState(true)\n  const [isModalOpen, setIsModalOpen] = useState(false)\n  const [editingAsset, setEditingAsset] = useState<Asset | null>(null)\n  const [selectedFilter, setSelectedFilter] = useState<string>('all')\n  const supabase = createClient()\n\n  useEffect(() => {\n    loadData()\n  }, [])\n\n  const loadData = async () => {\n    try {\n      const { data: { user } } = await supabase.auth.getUser()\n      \n      if (user) {\n        // Get family ID\n        const { data: family } = await supabase\n          .from('families')\n          .select('id')\n          .eq('user_id', user.id)\n          .single()\n\n        if (family) {\n          setFamilyId(family.id)\n          await loadAssets(family.id)\n        }\n      }\n    } catch (error) {\n      console.error('Error loading data:', error)\n    } finally {\n      setLoading(false)\n    }\n  }\n\n  const loadAssets = async (familyId: string) => {\n    const { data, error } = await supabase\n      .from('assets')\n      .select('*')\n      .eq('family_id', familyId)\n      .eq('category', 'insurance')\n      .order('created_at', { ascending: false })\n\n    if (error) {\n      console.error('Error loading assets:', error)\n    } else {\n      setAssets(data || [])\n    }\n  }\n\n  const handleSave = async (assetType: string, data: any) => {\n    if (!familyId) return\n\n    try {\n      if (editingAsset) {\n        // Update existing asset\n        const { error } = await supabase\n          .from('assets')\n          .update({\n            type: assetType,\n            data: data,\n            updated_at: new Date().toISOString(),\n          })\n          .eq('id', editingAsset.id)\n\n        if (error) throw error\n      } else {\n        // Create new asset\n        const { error } = await supabase\n          .from('assets')\n          .insert({\n            family_id: familyId,\n            category: 'insurance',\n            type: assetType,\n            data: data,\n          })\n\n        if (error) throw error\n      }\n\n      await loadAssets(familyId)\n      setIsModalOpen(false)\n      setEditingAsset(null)\n    } catch (error) {\n      console.error('Error saving asset:', error)\n      alert('Failed to save insurance policy. Please try again.')\n    }\n  }\n\n  const handleDelete = async (id: string) => {\n    if (!confirm('Are you sure you want to delete this insurance policy?')) return\n\n    try {\n      const { error } = await supabase\n        .from('assets')\n        .delete()\n        .eq('id', id)\n\n      if (error) throw error\n      if (familyId) await loadAssets(familyId)\n    } catch (error) {\n      console.error('Error deleting asset:', error)\n    }\n  }\n\n  const handleEdit = (asset: Asset) => {\n    setEditingAsset(asset)\n    setIsModalOpen(true)\n  }\n\n  const handleAddNew = () => {\n    setEditingAsset(null)\n    setIsModalOpen(true)\n  }\n\n  if (loading) {\n    return (\n      <div className=\"flex items-center justify-center h-full\">\n        <div className=\"text-center\">\n          <div className=\"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto\"></div>\n          <p className=\"mt-4 text-gray-600\">Loading...</p>\n        </div>\n      </div>\n    )\n  }\n\n  return (\n    <div className=\"max-w-7xl mx-auto\">\n      <div className=\"flex items-center justify-between mb-8\">\n        <div className=\"flex items-center space-x-4\">\n          <div className=\"w-12 h-12 bg-blue-500 rounded-lg flex items-center justify-center\">\n            <FontAwesomeIcon icon={faShieldAlt} className=\"text-white text-xl\" />\n          </div>\n          <div>\n            <h1 className=\"text-3xl font-bold text-gray-900\">Insurance</h1>\n            <p className=\"text-gray-600\">Manage your insurance policies</p>\n          </div>\n        </div>\n\n        <button\n          onClick={handleAddNew}\n          className=\"btn-primary\"\n        >\n          <FontAwesomeIcon icon={faPlus} className=\"mr-2\" />\n          Add Policy\n        </button>\n      </div>\n\n      {/* Filter by Sub-Category */}\n      <div className=\"mb-6\">\n        <div className=\"flex flex-wrap gap-2\">\n          {/* All filter */}\n          <button\n            onClick={() => setSelectedFilter('all')}\n            className={`px-4 py-2 rounded-lg border transition-all ${\n              selectedFilter === 'all'\n                ? 'bg-indigo-600 text-white border-indigo-600 shadow-md'\n                : 'bg-white text-gray-900 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50'\n            }`}\n          >\n            <span className=\"font-medium\">All</span>\n            <span className=\"ml-2 text-sm opacity-75\">({assets.length})</span>\n          </button>\n\n          {/* Category filters */}\n          {subCategories.map((sub) => {\n            const count = assets.filter(a => a.type === sub.id).length\n            return (\n              <button\n                key={sub.id}\n                onClick={() => setSelectedFilter(sub.id)}\n                className={`px-4 py-2 rounded-lg border transition-all ${\n                  selectedFilter === sub.id\n                    ? 'bg-indigo-600 text-white border-indigo-600 shadow-md'\n                    : 'bg-white text-gray-900 border-gray-200 hover:border-indigo-400 hover:bg-indigo-50'\n                }`}\n              >\n                <span className=\"font-medium\">{sub.title}</span>\n                <span className=\"ml-2 text-sm opacity-75\">({count})</span>\n              </button>\n            )\n          })}\n        </div>\n      </div>\n\n      {/* Assets Grid */}\n      {(() => {\n        const filteredAssets = selectedFilter === 'all' \n          ? assets \n          : assets.filter(a => a.type === selectedFilter)\n        \n        return filteredAssets.length === 0 ? (\n          <div className=\"text-center py-12 card\">\n            <FontAwesomeIcon icon={faShieldAlt} className=\"text-6xl text-gray-300 mb-4\" />\n            <h3 className=\"text-xl font-semibold text-gray-900 mb-2\">\n              {assets.length === 0 ? 'No Insurance Policies Yet' : 'No Policies in This Category'}\n            </h3>\n            <p className=\"text-gray-600 mb-6\">\n              {assets.length === 0 \n                ? 'Start by adding your first insurance policy'\n                : 'Try selecting a different category or add a new policy'\n              }\n            </p>\n            <button\n              onClick={handleAddNew}\n              className=\"btn-primary\"\n            >\n              <FontAwesomeIcon icon={faPlus} className=\"mr-2\" />\n              {assets.length === 0 ? 'Add Your First Policy' : 'Add Policy'}\n            </button>\n          </div>\n        ) : (\n          <div className=\"grid md:grid-cols-2 lg:grid-cols-3 gap-6\">\n            {filteredAssets.map((asset) => (\n              <AssetCard\n                key={asset.id}\n                asset={asset}\n                onEdit={handleEdit}\n                onDelete={handleDelete}\n              />\n            ))}\n          </div>\n        )\n      })()}\n\n      <AssetModal\n        isOpen={isModalOpen}\n        onClose={() => {\n          setIsModalOpen(false)\n          setEditingAsset(null)\n        }}\n        onSave={handleSave}\n        asset={editingAsset}\n        subCategories={subCategories}\n        category=\"insurance\"\n      />\n    </div>\n  )\n}\n"],"names":[],"mappings":"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"}